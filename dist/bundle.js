!function(e){var t={};function i(o){if(t[o])return t[o].exports;var s=t[o]={i:o,l:!1,exports:{}};return e[o].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=e,i.c=t,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(o,s,function(t){return e[t]}.bind(null,s));return o},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){"use strict";i.r(t);class o{constructor(e){this.data,this.emitter=e,this.elem=document.querySelector(".js-btn-removed"),this.onClick=this.onClick.bind(this),this.elem.addEventListener("click",this.onClick)}onClick(){const e={...this.data,status:"removed"};console.log(e),this.emitter.emit("data-update",e)}}class s{constructor(e){this.data,this.emitter=e,this.elem=document.querySelector(".js-btn-present"),this.onClick=this.onClick.bind(this),this.elem.addEventListener("click",this.onClick)}onClick(){const e={...this.data,status:"present"};this.emitter.emit("data-update",e)}}class n{constructor(e){this.elem=document.querySelector(".js-btn-save"),this.emitter=e,this.active=!1,this.data=[],this.update=this.update.bind(this),this.onClick=this.onClick.bind(this),this.elem.addEventListener("click",this.onClick)}async onClick(){await fetch("https://khab7rvd6c.execute-api.us-east-1.amazonaws.com/dev/mailbox",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.data)}),this.data={},this.emitter.emit("data-save")}update(e){this.active||(this.active=!0,this.elem.disabled=!1),this.data=e}}var c=class{constructor(e){this.emitter=e,this.containerElem=document.querySelector(".js-data-entry-container"),this.removedBtn=new o(e),this.presentBtn=new s(e),this.saveBtn=new n(e),this.collectionBoxInfo=document.querySelector(".js-collection-box-info"),this.show=this.show.bind(this),this.hide=this.hide.bind(this),this.update=this.update.bind(this)}update(e){const t=e.properties,i={outlet:t.OUTLETID,lat:e.geometry.coordinates[1],lng:e.geometry.coordinates[0]};this.removedBtn.data=i,this.presentBtn.data=i,this.collectionBoxInfo.innerHTML=`<p>Address:${t.ADDR1}</p><p>Outlet ID:${t.OUTLETID}</p>`}show(e){this.containerElem.classList.remove("data-entry-container--hidden"),this.update(e)}hide(){this.containerElem.classList.remove("data-entry-container--hidden")}};class a{constructor(e){this.emitter=e,this.elem=document.querySelector(".js-btn-back"),this.show=this.show.bind(this),this.hide=this.hide.bind(this),this.onClick=this.onClick.bind(this),this.elem.addEventListener("click",this.onClick)}onClick(){this.emitter.emit("show-map"),this.hide()}show(){this.elem.classList.remove("btn-back--hidden")}hide(){this.elem.classList.add("btn-back--hidden")}}var r,l=class{constructor(){this.timeOut,this.elem=document.querySelector(".snack"),this.showSnack=this.showSnack.bind(this)}showSnack(){clearTimeout(this.timeOut),this.elem.classList.remove("snack--hidden"),this.elem.classList.add("snack--visible"),this.timeOut=setTimeout(()=>{this.elem.classList.remove("snack--visible"),setTimeout(()=>{this.elem.classList.add("snack--hidden")},500)},2500)}};{const e={all:r=r||new Map,on:function(e,t){var i=r.get(e);i&&i.push(t)||r.set(e,[t])},off:function(e,t){var i=r.get(e);i&&i.splice(i.indexOf(t)>>>0,1)},emit:function(e,t){(r.get(e)||[]).slice().map((function(e){e(t)})),(r.get("*")||[]).slice().map((function(i){i(e,t)}))}},t=new c(e),i=new a(e),o=new l;function d(){document.querySelector(".overview-container").classList.remove("overview-container--hidden")}e.on("point-select",t.show),e.on("point-select",(function(){document.querySelector(".overview-container").classList.add("overview-container--hidden")})),e.on("point-select",i.show),e.on("data-update",t.saveBtn.update),e.on("show-map",d),e.on("show-map",t.hide),e.on("data-save",d),e.on("data-save",t.hide),e.on("data-save",o.showSnack),e.on("data-save",i.hide),e.on("data-save",(function(){fetch("https://khab7rvd6c.execute-api.us-east-1.amazonaws.com/dev/mailbox").then(e=>e.json()).then(e=>{s.getSource("collection-box-surveyed-src").setData(e)})})),mapboxgl.accessToken="pk.eyJ1IjoicnVzc2JpZ2dzIiwiYSI6ImNrZHg2am55ejE3aHYyeWtqOGtocjh4ejgifQ.Qg_LH8LUNchJZBPsqDme9g";const s=new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:[-106.65,35.08],zoom:9});s.addControl(new MapboxGeocoder({accessToken:mapboxgl.accessToken,mapboxgl:mapboxgl})),s.addControl(new mapboxgl.NavigationControl),s.addControl(new mapboxgl.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0})),fetch("https://khab7rvd6c.execute-api.us-east-1.amazonaws.com/dev/mailbox").then(e=>e.json()).then(t=>{s.on("load",(function(){s.addSource("collection-box-surveyed-src",{type:"geojson",data:t}),s.addSource("collection-box-src",{type:"vector",url:"mapbox://mikelmaron.3ws9y5k1"}),s.addLayer({id:"collection-boxes",type:"circle",source:"collection-box-src","source-layer":"collection_box_trim_valid-0tbyft",paint:{"circle-color":"#004B87","circle-radius":{base:4,stops:[[9,4],[22,180]]}}});s.addLayer({id:"collection-boxes-surveyed",type:"circle",source:"collection-box-surveyed-src",paint:{"circle-color":["match",["get","status"],"removed","#FF0000","present","#008000","#004B87"],"circle-radius":{base:4,stops:[[9,4],[22,180]]}}}),s.on("mouseenter","collection-boxes",(function(){s.getCanvas().style.cursor="pointer"})),s.on("mouseleave","collection-boxes",(function(){s.getCanvas().style.cursor=""})),s.on("click","collection-boxes",(function(t){e.emit("point-select",t.features[0])}))}))});"mediaDevices"in navigator&&console.log("media supported")}}]);